{"version":3,"file":"bundle.umd.js","sources":["src/HttpLink.js","src/HttpLinkModule.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { ApolloLink, Observable as LinkObservable, } from 'apollo-link';\nimport { print } from 'graphql/language/printer';\nimport { fetch, mergeHeaders, prioritize, } from 'apollo-angular-link-http-common';\n// XXX find a better name for it\nvar HttpLinkHandler = /** @class */ (function (_super) {\n    __extends(HttpLinkHandler, _super);\n    function HttpLinkHandler(httpClient, options) {\n        var _this = _super.call(this) || this;\n        _this.httpClient = httpClient;\n        _this.options = options;\n        _this.requester = function (operation) {\n            return new LinkObservable(function (observer) {\n                var context = operation.getContext();\n                // decides which value to pick, Context, Options or to just use the default\n                var pick = function (key, init) {\n                    return prioritize(context[key], _this.options[key], init);\n                };\n                var includeQuery = pick('includeQuery', true);\n                var includeExtensions = pick('includeExtensions', false);\n                var method = pick('method', 'POST');\n                var url = pick('uri', 'graphql');\n                var withCredentials = pick('withCredentials');\n                var req = {\n                    method: method,\n                    url: url,\n                    body: {\n                        operationName: operation.operationName,\n                        variables: operation.variables,\n                    },\n                    options: {\n                        withCredentials: withCredentials,\n                        headers: _this.options.headers,\n                    },\n                };\n                if (includeExtensions) {\n                    req.body.extensions = operation.extensions;\n                }\n                if (includeQuery) {\n                    req.body.query = print(operation.query);\n                }\n                if (context.headers) {\n                    req.options.headers = mergeHeaders(req.options.headers, context.headers);\n                }\n                var sub = fetch(req, _this.httpClient).subscribe({\n                    next: function (response) {\n                        operation.setContext({ response: response });\n                        observer.next(response.body);\n                    },\n                    error: function (err) { return observer.error(err); },\n                    complete: function () { return observer.complete(); },\n                });\n                return function () {\n                    if (!sub.closed) {\n                        sub.unsubscribe();\n                    }\n                };\n            });\n        };\n        return _this;\n    }\n    HttpLinkHandler.prototype.request = function (op) {\n        return this.requester(op);\n    };\n    return HttpLinkHandler;\n}(ApolloLink));\nexport { HttpLinkHandler };\nvar HttpLink = /** @class */ (function () {\n    function HttpLink(httpClient) {\n        this.httpClient = httpClient;\n    }\n    HttpLink.prototype.create = function (options) {\n        return new HttpLinkHandler(this.httpClient, options);\n    };\n    HttpLink.decorators = [\n        { type: Injectable },\n    ];\n    /** @nocollapse */\n    HttpLink.ctorParameters = function () { return [\n        { type: HttpClient }\n    ]; };\n    return HttpLink;\n}());\nexport { HttpLink };\n//# sourceMappingURL=HttpLink.js.map","import { NgModule } from '@angular/core';\nimport { HttpLink } from './HttpLink';\nexport var PROVIDERS = [HttpLink];\nvar HttpLinkModule = /** @class */ (function () {\n    function HttpLinkModule() {\n    }\n    HttpLinkModule.decorators = [\n        { type: NgModule, args: [{\n                    providers: PROVIDERS,\n                },] },\n    ];\n    return HttpLinkModule;\n}());\nexport { HttpLinkModule };\n//# sourceMappingURL=HttpLinkModule.js.map"],"names":["this","LinkObservable","prioritize","print","mergeHeaders","fetch","ApolloLink","Injectable","HttpClient","NgModule"],"mappings":"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"}